# 2D Diffusion Inverse Problem Configuration - CSV Data
# For use with synthetic CSV data or experimental microscopy data

# Physics parameters
physics:
  # True diffusion coefficient (for validation with synthetic data)
  # For experimental data, this may be unknown or estimated
  diff_coeff_true: 0.05    # In normalized units (or pixel²/frame for unnormalized)
  diff_coeff_init: 0.5     # Initial guess (deliberately far from true value)

# IDW weighting parameters
idw:
  ema_beta: 0.9             # EMA smoothing for gradient energies
  eps: 1.0e-12              # Small epsilon to avoid divide-by-zero
  clamp_min: 1.0e-3         # Clamp raw weights minimum (stability)
  clamp_max: 1.0e+3         # Clamp raw weights maximum (stability)
  weight_sum_target: 3.0    # Three tasks (BC/IC, Data, PDE) -> normalize to sum = 3
  freeze_before_lbfgs: true # Freeze learned weights before L-BFGS

# Training parameters
training:
  adam_lr: 1.0e-3           # Adam optimizer learning rate
  adam_epochs: 4000         # Number of Adam epochs (more for CSV data)
  print_every: 200          # Print/log frequency
  
  # L-BFGS parameters
  lbfgs_maxiter: 4000
  lbfgs_maxfun: 2000
  lbfgs_maxcor: 200
  lbfgs_ftol: 2.220446049250313e-09
  lbfgs_gtol: 5.0e-8
  lbfgs_maxls: 50

# Data parameters - CSV format
data:
  input_file: "data/synthetic_diffusion.csv"   # Path to CSV file
  data_format: "csv"                           # "csv" or "mat"
  n_u: 200                                     # BC/IC points (more for larger grids)
  n_f: 2000                                    # Collocation points
  n_obs: 500                                   # Interior observation points
  
  # Normalization options
  normalize_coords: true      # Normalize x,y,t to [0,1]
  normalize_intensity: true   # Normalize intensity to [0,1]

# Unit conversion (for experimental data)
# These are used to convert learned D back to physical units
units:
  pixel_size_um: null         # Pixel size in micrometers (set for experimental data)
  frame_time_s: null          # Time between frames in seconds (set for experimental data)
  # Example for typical microscopy:
  # pixel_size_um: 0.65       # 0.65 µm/pixel
  # frame_time_s: 1.0         # 1 second between frames

# Network architecture
network:
  layers: [3, 64, 64, 64, 64, 1]  # [input(x,y,t), hidden..., output(u)]
